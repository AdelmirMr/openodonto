<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:oo="http://code.google.com/p/openodonto"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j">
	<rich:modalPanel id="procedimentosOdontograma" autosized="true" width="640" resizeable="false">
	    <f:facet name="header">
		    <h:outputText value="Odontograma Procedimentos" />
        </f:facet>
        <f:facet name="controls">
            <h:panelGroup>
				<a4j:commandButton image="#{msg.imgBotaoFechar}" reRender="#{formName}" value="#{msg.acaoFechar}" id="hidelinkProcedimentos" styleClass="hidelink">
					<rich:componentControl for="procedimentosOdontograma" attachTo="hidelinkProcedimentos" operation="hide" event="onclick"/>
				</a4j:commandButton>
            </h:panelGroup>
        </f:facet>
        <center>        
        <rich:panel id="procedimentosOdontogramaMeta">
        	<h:panelGrid columns="3">
        		<h:panelGroup layout="block">
        		    <h:outputLabel value="Dente Nome : " style="font-weight : bold"/>
        		    <h:outputText value="#{manage.od.dente.nome}" />
        		</h:panelGroup>
        		<h:panelGroup layout="block">
        		    <h:outputLabel value="Dente Numero : " style="font-weight : bold"/>
        		    <h:outputText value="#{manage.od.dente.numero}" />
        		</h:panelGroup>
        		<h:panelGroup layout="block">
        		    <h:outputLabel value="Face : " style="font-weight : bold" />
        		    <h:outputText value="#{manage.od.face.nome}" />
        		</h:panelGroup>
        	</h:panelGrid>
        </rich:panel>
        </center>                
        <a4j:form id="formProcedimentosOdontograma" ajaxSubmit="true" >        
       	<oo:maskMoney name="moneyMask" time="onJScall" />
       	<a4j:jsFunction name="copiaValor" action="#{manage.acaoCopiaValor}" reRender="entradaValor"/>
        <rich:panel>
        	<center>
            <h:panelGrid columns="6">
                <h:panelGrid>
                	<oo:label value="Procedimento" for="labelProcedimento" />
                	<rich:inplaceSelect id="inplaceProcedimento"  value="#{manage.procedimentoAdd}" onviewactivated="copiaValor()" defaultLabel="Selecione um procedimento" converter="simpleEntityConverter">
                		<t:selectItems id="itemsProcedimentos" value="#{list.ALIAS_PROC.dominio}" var="procedimento" itemLabel="#{procedimento.nome}" itemValue="#{procedimento}"/>
                	</rich:inplaceSelect>
                </h:panelGrid>
                <rich:spacer width="16px" />
                <h:panelGrid>
                	<h:outputLabel value="Status" />
                	<rich:inplaceSelect id="inplaceStatusProcedimento" defaultLabel="Selecione um status" value="#{manage.statusAdd}" converter="simpleEntityConverter"  >
                		<t:selectItems id="itemsStatusProcedimentos" value="#{list.ALIAS_STATUS_PROC.dominio}" var="status" itemLabel="#{status.nome}" itemValue="#{status}" />
                	</rich:inplaceSelect>             
                </h:panelGrid>
                <rich:spacer width="16px" />
                <h:panelGrid>
                	<oo:label value="Valor" for="entradaValor" />
					<h:inputText id="entradaValor" value="#{manage.valorAdd}" style=" width : 80px;" onfocus="moneyMask(this)" styleClass="maskMoney">
						<f:convertNumber type="currency" />
					</h:inputText>
                </h:panelGrid>
                <h:panelGrid>
                	<h:outputLabel value="Data" />
                	<rich:calendar inputStyle="width : 80px" datePattern="dd/MM/yyyy" enableManualInput="false" zindex="101" value="#{manage.dataAdd}">
                		<f:converter converterId="SqlDateConverter" />
                	</rich:calendar>
                </h:panelGrid>                
            </h:panelGrid>
            <h:panelGrid>
            	<oo:label value="Observacao" for="entradaObservacao" />
            	<h:inputTextarea value="#{manage.observacaoAdd}" style="width : 400px" />
            </h:panelGrid>
            </center>
            <h:panelGroup style="width : 600px;text-align : right" layout="block">
            	<h:commandButton action="#{manage.acaoAddOdp}" value="Adicionar" />
            </h:panelGroup>
        </rich:panel>
        <rich:panel>       	
        <center>
            <h:panelGrid>
                <a4j:jsFunction name="reloadObs" reRender="listaProcedimentosOdontograma" />
                <rich:scrollableDataTable rowKeyVar="row" id="listaProcedimentosOdontograma" value="#{manage.procedimentos}" var="odp" onRowMouseOver="dataTabeMouseOver(this)" onRowMouseOut="dataTabeMouseOut(this,'#{a4jSkin.tableBackgroundColor}')" width="660px" height="230px" rows="10" >                    
                	<rich:column width="36px">
                	    <h:panelGroup layout="block" style="text-align : center">
							<a4j:commandButton value="#{msg.manageContactAcaoRemover}" action="#{manage.acaoRemoverOdp}" reRender="listaProcedimentosOdontograma,gridOdontograma" image="#{msg.imgBotaoMiniRemove}">
							    <f:setPropertyActionListener value="#{odp}" target="#{manage.procedimento}" />
							</a4j:commandButton>                	    	
                	    </h:panelGroup>
                	</rich:column>
                	<rich:column width="150px">
                	    <f:facet name="header">
                	    	<h:outputText value="Nome" />
                	    </f:facet>
                	    <h:panelGroup layout="block" style="text-align : center">
                	    	<h:outputText id="procNome" value="#{odp.procedimento.nome}" >
                	    	    <rich:toolTip for="procNome" value="#{odp.procedimento.descricao}" />
                	    	</h:outputText>
                	    </h:panelGroup>
                	</rich:column>
                	<rich:column width="135px">
                	    <f:facet name="header">
                	    	<h:outputText value="Status" />
                	    </f:facet>
                	    <h:panelGroup layout="block" style="text-align : center">
                	    	<h:selectOneMenu enableManualInput="false" id="selectStatusProc" value="#{odp.odp.status}" onchange="$('formProcedimentosOdontograma').submit();" converter="simpleEntityConverter" >
                	    		<t:selectItems id="itemsStatus" value="#{list.ALIAS_STATUS_PROC.dominio}" var="status" itemLabel="#{status.nome}" itemValue="#{status}" />
                	    	</h:selectOneMenu>
                	    </h:panelGroup>
                	</rich:column>
                	<rich:column width="80px">
                	    <f:facet name="header">
                	    	<h:outputText value="Data" />
                	    </f:facet>
                	    <h:panelGroup layout="block" style="text-align : center">
                	    	<h:outputText value="#{odp.odp.data}" />
                	    </h:panelGroup>
                	</rich:column>
                	<rich:column width="150px">
                	    <f:facet name="header">
                	    	<h:outputText value="Observacao" />
                	    </f:facet>                	    
                		<h:panelGroup layout="block" style="text-align : center">                	    
                	   		<rich:inplaceInput onmouseover="tooltip.show('#{odp.odp.observacao}');" onmouseout="tooltip.hide();" id="inplaceObs" viewClass="oo-odontograma-procedimentos-inplace" inputWidth="150px" onblur="align_div(this.parentNode.parentNode,'center')" onchange="$('formProcedimentosOdontograma').submit();reloadObs()" oneditactivation="jQuery(this.firstChild).val('#{odp.odp.observacao}');align_div(this.parentNode,'left');" value="#{odp.observacao}"/>            	    	
                		</h:panelGroup>
                	</rich:column>
                	<rich:column width="100">
                	    <f:facet name="header">
                	    	<h:outputText value="Valor" />
                	    </f:facet>
                	    <h:panelGroup layout="block" style="text-align : center">
                	    	<rich:inplaceInput inputWidth="100" id="inplaceProcEntradaValor" value="#{odp.valor}"  onblur="align_div(this.parentNode.parentNode,'center')" onchange="$('formProcedimentosOdontograma').submit();" oneditactivation="align_div(this.parentNode,'left');moneyMask(this.firstChild)" />
                	    </h:panelGroup>
                	</rich:column>
                </rich:scrollableDataTable>
            </h:panelGrid>
        </center>
        </rich:panel>
        </a4j:form>
	</rich:modalPanel>
</ui:composition>